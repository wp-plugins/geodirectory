// Generated by CoffeeScript 1.4.0
(function(e){return e.fn.ajaxChosen=function(t,n,r){var i,s,o,u;return t==null&&(t={}),r==null&&(r={}),s={minTermLength:0,afterTypeDelay:500,addSearchTermOnNorecord:0,noLocationUrl:0,jsonTermKey:"term",jsonTermKeyObject:"term",keepTypingMsg:"Keep typing...",lookingForMsg:"Looking for"},u=this,i=null,o=e.extend({},s,e(u).data(),t),this.chosen(r?r:{}),this.each(function(){return e(this).next(".geodir-chosen-container").find(".search-field > input, .chosen-search > input").bind("keyup",function(){var r,s,a,f,l;return f=e(this).val(),l=e.trim(e(this).val()),s=l.length<o.minTermLength?o.keepTypingMsg:o.lookingForMsg+(" '"+l+"'"),u.next(".geodir-chosen-container").find(".no-results").text(s),e(this).data("prevVal",l),this.timer&&clearTimeout(this.timer),l.length<o.minTermLength?!1:(l.length==0&&(u.find("option").each(function(){return e(this).remove()}),e("<option />").attr("value","").html("").appendTo(u),u.trigger("chosen:updated")),r=e(this),o.data==null&&(o.data={}),o.data[o.jsonTermKey]=l,o.dataCallback!=null&&(o.data=o.dataCallback(o.data)),a=o.success,o.success==null&&(o.success=function(i){var s,o,a;if(i==null)return;a=[],u.find("option").each(function(){return e(this).is(":selected")?a.push(e(this).val()+"-"+e(this).text()):e(this).remove()}),u.find("optgroup:empty").each(function(){return e(this).remove()}),s=n!=null?n(i,r):i,o=0,e.each(s,function(t,n){var r,i,s;o++;if(n.group)return r=u.find("optgroup[label='"+n.text+"']"),r.size()||(r=e("<optgroup />")),r.attr("label",n.text).appendTo(u),e.each(n.items,function(t,n){var i,s;typeof n=="string"?(s=t,i=n):(s=n.value,i=n.text);if(e.inArray(s+"-"+i,a)===-1)return e("<option />").attr("value",s).html(i).appendTo(r)});typeof n=="string"?(s=t,i=n):(s=n.value,i=n.text);if(e.inArray(s+"-"+i,a)===-1)return e("<option />").attr("value",s).html(i).appendTo(u)}),o?u.trigger("chosen:updated"):(u.data().chosen.no_results_clear(),u.data().chosen.no_results(r.val())),t.success!=null&&t.success(i)}),this.timer=setTimeout(function(){return i&&i.abort(),i=e.ajax(o)},o.afterTypeDelay))})})}})(jQuery);