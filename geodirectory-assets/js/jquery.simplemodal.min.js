/*
 * SimpleModal 1.4.4 - jQuery Plugin
 * http://simplemodal.com/
 * Copyright (c) 2013 Eric Martin
 * Licensed under MIT and GPL
 * Date: Sun, Jan 20 2013 15:58:56 -0800
 */(function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){var t=[],n=e(document),r=navigator.userAgent.toLowerCase(),i=e(window),s=[],o=null,u=/msie/.test(r)&&!/opera/.test(r),a=/opera/.test(r),f,l;f=u&&/msie 6./.test(r)&&"object"!=typeof window.XMLHttpRequest,l=u&&/msie 7.0/.test(r),e.gdmodal=function(t,n){return e.gdmodal.impl.init(t,n)},e.gdmodal.close=function(){e.gdmodal.impl.close()},e.gdmodal.focus=function(t){e.gdmodal.impl.focus(t)},e.gdmodal.setContainerDimensions=function(){e.gdmodal.impl.setContainerDimensions()},e.gdmodal.setPosition=function(){e.gdmodal.impl.setPosition()},e.gdmodal.update=function(t,n){e.gdmodal.impl.update(t,n)},e.fn.gdmodal=function(t){return e.gdmodal.impl.init(this,t)},e.gdmodal.defaults={appendTo:"body",focus:!0,opacity:50,overlayId:"simplemodal-overlay",overlayCss:{},containerId:"simplemodal-container",containerCss:{},dataId:"simplemodal-data",dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:!1,autoPosition:!0,zIndex:99997,close:!0,closeHTML:'<a class="modalCloseImg" title="Close"></a>',closeClass:"simplemodal-close",escClose:!0,overlayClose:!1,fixed:!0,position:null,persist:!1,gdmodal:!0,onOpen:null,onShow:null,onClose:null},e.gdmodal.impl={d:{},init:function(t,n){if(this.d.data)return!1;o=u&&document.compatMode==="BackCompat",this.o=e.extend({},e.gdmodal.defaults,n),this.zIndex=this.o.zIndex,this.occb=!1;if("object"==typeof t){if(t=t instanceof e?t:e(t),this.d.placeholder=!1,0<t.parent().parent().size()&&(t.before(e("<span></span>").attr("id","simplemodal-placeholder").css({display:"none"})),this.d.placeholder=!0,this.display=t.css("display"),!this.o.persist))this.d.orig=t.clone(!0)}else{if("string"!=typeof t&&"number"!=typeof t)return alert("SimpleModal Error: Unsupported data type: "+typeof t),this;t=e("<div></div>").html(t)}return this.create(t),this.open(),e.isFunction(this.o.onShow)&&this.o.onShow.apply(this,[this.d]),this},create:function(n){this.getDimensions(),this.o.gdmodal&&f&&(this.d.iframe=e('<iframe src="javascript:false;"></iframe>').css(e.extend(this.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:s[0],width:s[1],zIndex:this.o.zIndex,top:0,left:0})).appendTo(this.o.appendTo)),this.d.overlay=e("<div></div>").attr("id",this.o.overlayId).addClass("simplemodal-overlay").css(e.extend(this.o.overlayCss,{display:"none",opacity:this.o.opacity/100,height:this.o.gdmodal?t[0]:0,width:this.o.gdmodal?t[1]:0,position:"fixed",left:0,top:0,zIndex:this.o.zIndex+1})).appendTo(this.o.appendTo),this.d.container=e("<div></div>").attr("id",this.o.containerId).addClass("simplemodal-container").css(e.extend({position:this.o.fixed?"fixed":"absolute"},this.o.containerCss,{display:"none",zIndex:this.o.zIndex+2})).append(this.o.close&&this.o.closeHTML?e(this.o.closeHTML).addClass(this.o.closeClass):"").appendTo(this.o.appendTo),this.d.wrap=e("<div></div>").attr("tabIndex",-1).addClass("simplemodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(this.d.container),this.d.data=n.attr("id",n.attr("id")||this.o.dataId).addClass("simplemodal-data").css(e.extend(this.o.dataCss,{display:"none"})).appendTo("body"),this.setContainerDimensions(),this.d.data.appendTo(this.d.wrap),(f||o)&&this.fixIE()},bindEvents:function(){var r=this;e("."+r.o.closeClass).bind("click.simplemodal",function(e){e.preventDefault(),r.close()}),r.o.gdmodal&&r.o.close&&r.o.overlayClose&&r.d.overlay.bind("click.simplemodal",function(e){e.preventDefault(),r.close()}),n.bind("keydown.simplemodal",function(e){r.o.gdmodal&&9===e.keyCode?r.watchTab(e):r.o.close&&r.o.escClose&&27===e.keyCode&&(e.preventDefault(),r.close())}),i.bind("resize.simplemodal orientationchange.simplemodal",function(){r.getDimensions(),r.o.autoResize?r.setContainerDimensions():r.o.autoPosition&&r.setPosition(),f||o?r.fixIE():r.o.gdmodal&&(r.d.iframe&&r.d.iframe.css({height:s[0],width:s[1]}),r.d.overlay.css({height:t[0],width:t[1]}))})},unbindEvents:function(){e("."+this.o.closeClass).unbind("click.simplemodal"),n.unbind("keydown.simplemodal"),i.unbind(".simplemodal"),this.d.overlay.unbind("click.simplemodal")},fixIE:function(){var t=this.o.position;e.each([this.d.iframe||null,this.o.gdmodal?this.d.overlay:null,"fixed"===this.d.container.css("position")?this.d.container:null],function(e,n){if(n){var r=n[0].style;r.position="absolute";if(2>e)r.removeExpression("height"),r.removeExpression("width"),r.setExpression("height",'document.body.scrollHeight > document.body.clientHeight ? document.body.scrollHeight : document.body.clientHeight + "px"'),r.setExpression("width",'document.body.scrollWidth > document.body.clientWidth ? document.body.scrollWidth : document.body.clientWidth + "px"');else{var i,s;t&&t.constructor===Array?(i=t[0]?"number"==typeof t[0]?t[0].toString():t[0].replace(/px/,""):n.css("top").replace(/px/,""),i=-1===i.indexOf("%")?i+' + (t = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"':parseInt(i.replace(/%/,""))+' * ((document.documentElement.clientHeight || document.body.clientHeight) / 100) + (t = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"',t[1]&&(s="number"==typeof t[1]?t[1].toString():t[1].replace(/px/,""),s=-1===s.indexOf("%")?s+' + (t = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft) + "px"':parseInt(s.replace(/%/,""))+' * ((document.documentElement.clientWidth || document.body.clientWidth) / 100) + (t = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft) + "px"')):(i='(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (t = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"',s='(document.documentElement.clientWidth || document.body.clientWidth) / 2 - (this.offsetWidth / 2) + (t = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft) + "px"'),r.removeExpression("top"),r.removeExpression("left"),r.setExpression("top",i),r.setExpression("left",s)}}})},focus:function(t){var n=this,t=t&&-1!==e.inArray(t,["first","last"])?t:"first",r=e(":input:enabled:visible:"+t,n.d.wrap);setTimeout(function(){0<r.length?r.focus():n.d.wrap.focus()},10)},getDimensions:function(){var e="undefined"==typeof window.innerHeight?i.height():window.innerHeight;t=[n.height(),n.width()],s=[e,i.width()]},getVal:function(e,t){return e?"number"==typeof e?e:"auto"===e?0:0<e.indexOf("%")?parseInt(e.replace(/%/,""))/100*("h"===t?s[0]:s[1]):parseInt(e.replace(/px/,"")):null},update:function(e,t){if(!this.d.data)return!1;this.d.origHeight=this.getVal(e,"h"),this.d.origWidth=this.getVal(t,"w"),this.d.data.hide(),e&&this.d.container.css("height",e),t&&this.d.container.css("width",t),this.setContainerDimensions(),this.d.data.show(),this.o.focus&&this.focus(),this.unbindEvents(),this.bindEvents()},setContainerDimensions:function(){var e=f||l,t=this.d.origHeight?this.d.origHeight:a?this.d.container.height():this.getVal(e?this.d.container[0].currentStyle.height:this.d.container.css("height"),"h"),e=this.d.origWidth?this.d.origWidth:a?this.d.container.width():this.getVal(e?this.d.container[0].currentStyle.width:this.d.container.css("width"),"w"),n=this.d.data.outerHeight(!0),r=this.d.data.outerWidth(!0);this.d.origHeight=this.d.origHeight||t,this.d.origWidth=this.d.origWidth||e;var i=this.o.maxHeight?this.getVal(this.o.maxHeight,"h"):null,o=this.o.maxWidth?this.getVal(this.o.maxWidth,"w"):null,i=i&&i<s[0]?i:s[0],o=o&&o<s[1]?o:s[1],u=this.o.minHeight?this.getVal(this.o.minHeight,"h"):"auto",t=t?this.o.autoResize&&t>i?i:t<u?u:t:n?n>i?i:this.o.minHeight&&"auto"!==u&&n<u?u:n:u,i=this.o.minWidth?this.getVal(this.o.minWidth,"w"):"auto",e=e?this.o.autoResize&&e>o?o:e<i?i:e:r?r>o?o:this.o.minWidth&&"auto"!==i&&r<i?i:r:i;this.d.container.css({height:t,width:e}),this.d.wrap.css({overflow:n>t||r>e?"auto":"visible"}),this.o.autoPosition&&this.setPosition()},setPosition:function(){var e,t;e=s[0]/2-this.d.container.outerHeight(!0)/2,t=s[1]/2-this.d.container.outerWidth(!0)/2;var n="fixed"!==this.d.container.css("position")?i.scrollTop():0;this.o.position&&"[object Array]"===Object.prototype.toString.call(this.o.position)?(e=n+(this.o.position[0]||e),t=this.o.position[1]||t):e=n+e,this.d.container.css({left:t,top:e})},watchTab:function(t){if(0<e(t.target).parents(".simplemodal-container").length){if(this.inputs=e(":input:enabled:visible:first, :input:enabled:visible:last",this.d.data[0]),!t.shiftKey&&t.target===this.inputs[this.inputs.length-1]||t.shiftKey&&t.target===this.inputs[0]||0===this.inputs.length)t.preventDefault(),this.focus(t.shiftKey?"last":"first")}else t.preventDefault(),this.focus()},open:function(){this.d.iframe&&this.d.iframe.show(),e.isFunction(this.o.onOpen)?this.o.onOpen.apply(this,[this.d]):(this.d.overlay.show(),this.d.container.show(),this.d.data.show()),this.o.focus&&this.focus(),this.bindEvents()},close:function(){if(!this.d.data)return!1;this.unbindEvents();if(e.isFunction(this.o.onClose)&&!this.occb)this.occb=!0,this.o.onClose.apply(this,[this.d]);else{if(this.d.placeholder){var t=e("#simplemodal-placeholder");this.o.persist?t.replaceWith(this.d.data.removeClass("simplemodal-data").css("display",this.display)):(this.d.data.hide().remove(),t.replaceWith(this.d.orig))}else this.d.data.hide().remove();this.d.container.hide().remove(),this.d.overlay.hide(),this.d.iframe&&this.d.iframe.hide().remove(),this.d.overlay.remove(),this.d={}}}}});